<!DOCTYPE html>
<html>
    <head>
        <title>simon</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="jquery-3.1.0.min.js"></script>
        <script>
            $(document).ready(function () {
                check();
            });

            function check() {
                $.get('check', function (hosts) {
                    var html = '<h1>' + hosts.name + '</h1>';
                    hosts.group.forEach(function (group) {
                        html += '<h2>' + group.name + '</h2>';
                        group.host.forEach(function (host) {
                            var color = host.status > 200 ? 'LightRed' : 'LightGreen';
                            html += '<table><tr style="background-color: ' + color + '">';
                            html += '<td width="200">' + host.name + '</td>';
                            html += '<td width="300">' + host.url + '</td>';
                            html += '<td width="50">' + host.status + '</td>';
                            html += '<td width="50" align="right">' + host.time + ' ms</td>';
                            html += '</tr></table>';
                        });
                    });
                    html += "<br>";
                    html += '<p>Last refresh: ' + new Date() + '</p>';
                    
                    $('#content').html(html);
                });
            }

            var interval;
            var autorefresh = false;

            function switchAutoRefresh() {
                autorefresh = !autorefresh;
                
                var text = autorefresh ? 'Toggle auto refresh off' : 'Toggle auto refresh on';
                $('#autorefresh').text(text);
                
                if (autorefresh) {
                    interval = setInterval(function () {
                        check();
                    }, 10000);
                } else {
                    clearInterval(interval);
                }
            }
        </script>
    </head>
    <body>
        <div id="content">Loading...</div>

        <a id="autorefresh" href="#" onclick="switchAutoRefresh()">Toggle auto refresh on</a>
    </body>
</html>
